

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>8.1. Working &#8212; Introduction to Mechatronics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=927b94d3fcb96560df09" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=927b94d3fcb96560df09" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jsAnim.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/myThemeVars.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=927b94d3fcb96560df09" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=927b94d3fcb96560df09" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=927b94d3fcb96560df09"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.24.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
    <script src="../../_static/jsAnim.js"></script>
    <script src="../../_static/logoChanger.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script src="../../_static/skins.js"></script>
    <script src="../../_static/wavedrom.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'chap08/sec01/working';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="8.2. hardware_i2c Library Functions" href="../sec02/libraryFunctions.html" />
    <link rel="prev" title="8. Inter-Integrated Circuit" href="../i2c.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logoLight.svg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../../_static/logoLight.svg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Welcome to Introduction to Mechatronics notes webpage
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Prerequisites</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../chap01/summaryOfBasicCCppProgramming.html">1. Summary of Basic C/C++ Programming</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chap01/sec01/programStructure.html">1.1. Program Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap01/sec02/basicSyntax.html">1.2. Basic Syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap01/sec03/dataTypes.html">1.3. Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap01/sec04/variables.html">1.4. Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap01/sec05/constantsAndLiterals.html">1.5. Constants and Literals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap01/sec06/operators.html">1.6. Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap01/sec07/decisionMaking.html">1.7. Decision Making</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap01/sec08/loops.html">1.8. Loops</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap01/sec09/functions.html">1.9. Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap01/sec10/scopeRules.html">1.10. Scope Rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap01/sec11/arrays.html">1.11. Arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap01/sec12/strings.html">1.12. Strings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap01/sec13/preprocessors.html">1.13. Preprocessors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap01/sec14/typeCasting.html">1.14. Type Casting</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduction</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../chap02/preliminaries.html">2. Preliminaries</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chap02/sec01/numberSystems.html">2.1. Number Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap02/sec02/upVSuc.html">2.2. What is a Microcontroller?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap02/sec03/clocks.html">2.3. Clock Controls Everything</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap02/sec04/storages.html">2.4. Information Storage in μC</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../chap03/theMicrocontrollerAndCodeDevelopment.html">3. The μC and Code Development</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chap03/sec01/raspberryPiPico.html">3.1. RP2040 and Raspberry Pi Pico</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap03/sec02/codeDevelopmentProcess.html">3.2. Code Development Process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap03/sec03/ucLaptopComm.html">3.3. μC-Laptop Communication</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Peripherals</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../chap04/gpio.html">4. General Purpose Input Output</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chap04/sec01/working.html">4.1. Working</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap04/sec02/libraryFunctions.html">4.2. <code class="docutils literal notranslate"><span class="pre">hardware_gpio</span></code> Library Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap04/sec03/codeExamples.html">4.3. Code Examples</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../chap05/adc.html">5. Analog to Digital Converter</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chap05/sec01/working.html">5.1. Working</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap05/sec02/libraryFunctions.html">5.2. <code class="docutils literal notranslate"><span class="pre">hardware_adc</span></code> Library Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap05/sec03/codeExamples.html">5.3. Code Examples</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../chap06/pwm.html">6. Pulse Width Modulation</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chap06/sec01/working.html">6.1. Working</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap06/sec02/libraryFunctions.html">6.2. <code class="docutils literal notranslate"><span class="pre">hardware_pwm</span></code> Library Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap06/sec03/codeExamples.html">6.3. Code Examples</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../chap07/uart.html">7. Universal Asynchronous Receiver-Transmitter</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chap07/sec01/working.html">7.1. Working</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap07/sec02/libraryFunctions.html">7.2. <code class="docutils literal notranslate"><span class="pre">hardware_uart</span></code> Library Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap07/sec03/codeExamples.html">7.3. Code Examples</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../i2c.html">8. Inter-Integrated Circuit</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">8.1. Working</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sec02/libraryFunctions.html">8.2. <code class="docutils literal notranslate"><span class="pre">hardware_i2c</span></code> Library Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sec03/codeExamples.html">8.3. Code Examples</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../chap09/timer.html">9. Timer</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../chap09/sec01/libraryFunctions.html">9.1. <code class="docutils literal notranslate"><span class="pre">hardware_timer</span></code> Library Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../chap09/sec02/codeExamples.html">9.2. Code Examples</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendices</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../appnA/softwareInstallation.html">Software Installation</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../appnA/sec01/armToolchain.html">Arm Toolchain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../appnA/sec02/textEditor.html">Text Editor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../appnA/sec03/piPicoSDK.html">Raspberry Pi Pico C/C++ SDK</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../appnA/sec04/helloWorld.html">Hello World!</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/vxj9800/mae3185Notes" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/vxj9800/mae3185Notes/issues/new?title=Issue%20on%20page%20%2Fchap08/sec01/working.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/chap08/sec01/working.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Working</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-sup-2-sup-c-message">8.1.1. I<sup>2</sup>C Message</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example">8.1.2. Example</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#baud-rate">8.1.3. Baud Rate</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="working">
<h1><span class="section-number">8.1. </span>Working<a class="headerlink" href="#working" title="Permalink to this heading">#</a></h1>
<p>We know that the voltage in both SCL and SDA lines is high during the idle state. The clock signal in SCL line is always generated by the controller. While the SDA line voltages can be changed by both the controller and the target. These changes are allowed to happen only when the SCL line is low except for <strong>Start</strong> and <strong>Stop</strong> conditions. Furthermore, the voltage measurement, indicating the value of a bit, is done only when the SCL line is high.</p>
<p>There are two challenges that needs to be tackled before the real information is communicated.</p>
<ol class="arabic simple">
<li><p>The controller has to specify which target it wants to communicate with since there can be more than one targets.</p></li>
<li><p>The controller has to define the flow of information since both the controller and a target cannot transmit data on the SDA line at the same time.</p></li>
</ol>
<section id="i-sup-2-sup-c-message">
<h2><span class="section-number">8.1.1. </span>I<sup>2</sup>C Message<a class="headerlink" href="#i-sup-2-sup-c-message" title="Permalink to this heading">#</a></h2>
<p>Tackling of these challenges and the communication of the information is handled through I<sup>2</sup>C messages.</p>
<p>An I<sup>2</sup>C message always starts with a <strong>Start</strong> condition, where the controller pulls the SDA line low, i.e. the voltage is changed from 3.3V to 0V, while the SCL line is kept high.</p>

<div style="overflow-x:auto">
<script type="WaveDrom">
{signal: [
    {name: 'SDA', wave: '1.0....5.....................................................................5.........4.........z', node: 'A...B', data: [
        "7-bit Address",
        "Read/Write",
        "Ack/Nack"
        ], period: 0.5
    },
    {name: 'SCL', wave: '1....l....H....l....H....l....H....l....H....l....H....l....H....l....H....l....H....l....H....l..', period: 0.5
}
],
edge: ['A-B Start'
],
config: {skin:'narrow'
}
}
</script>
</div>
<p>The start condition is always followed by 7 or 10 bit <strong>Address</strong>. This is where the controller specifies which target it wants to communicate with. After the address, the controller sends a <strong>Read/Write</strong> bit. As the name suggests, it sends a 0 if it wants to write/transmit some data to the target otherwise it sends a 1 to read/receive some data. The controller releases the SDA line at this point for a target to change the voltage. If no target exists with the address specified by the controller, then the SDA line voltage stays high due to pull-up resistor representing a <strong>N</strong>o <strong>ack</strong>nowledgement. However, if a target does exist with the address specified, then it pulls the SDA line low as an <strong>Ack</strong>nowledgement.</p>
<p>If the Ack was received and the Read/Write bit was 1 during the communication so far, then the control of SDA line is left with the target. Now the target can send 8-bits of data during next 8 clock cycles as shown in the figure below.</p>

<div style="overflow-x:auto">
<script type="WaveDrom">
{signal: [
    {name: 'SDA', wave: 'z4..............................................0.....z|4..............................................1.....0...1.', node: '................................................A.....B................................................C.....D.E...F', data: [
        "8-bit Data",
        "8-bit Data"
        ], period: 0.5
    },
    {name: 'SCL', wave: 'l.H..l..H..l..H..l..H..l..H..l..H..l..H..l..H..l..H..l.|.H..l..H..l..H..l..H..l..H..l..H..l..H..l..H..l..H..l..H...', period: 0.5
}
],
edge: ['A-B Ack','C-D Nack','E-F Stop'
],
config: {skin:'narrow'
}
}
</script>
</div>
<p>After the 8-bits of data, the controller sends an Ack to let the target know that it can send more data. This way, multiple bytes of data can be sent by the target. If the controller wants to stop receiving data, then it sends a Nack after any of the 8 data bits. This Nack bit can be followed by a <strong>Stop</strong> condition to indicate the end of a message, where the controller pulls the SDA line high while maintaining the SCL line as high.</p>
<p>To the contrary, if the Ack was received and the Read/Write bit was 0 during the initial communication, then the control handles the SDA line to transmit data in chunks of 8-bits as shown in the figure below.</p>

<div style="overflow-x:auto">
<script type="WaveDrom">
{signal: [
    {name: 'SDA', wave: 'z5..............................................0.....z|5..............................................0.....0...1.', node: '................................................A.....B................................................C.....D.E...F', data: [
        "8-bit Data",
        "8-bit Data"
        ], period: 0.5
    },
    {name: 'SCL', wave: 'l.H..l..H..l..H..l..H..l..H..l..H..l..H..l..H..l..H..l.|.H..l..H..l..H..l..H..l..H..l..H..l..H..l..H..l..H..l..H...', period: 0.5
}
],
edge: ['A-B Ack','C-D Ack','E-F Stop'
],
config: {skin:'narrow'
}
}
</script>
</div>
<p>Similar to the controller sending Ack after receiving every 8-bit chunk, here the target sends an Ack after receiving every 8-bit chunk. However, if the target sends a Nack after any byte then it can either mean that the target doesn’t understand the data received or the target is busy so it cannot process new data anymore. Regardless, the controller is allowed to end the message by sending the Stop condition after any of the Ack/Nack bit sent by the target.</p>
<p>The discussion of the I<sup>2</sup>C protocol so far is a concised version of the full I<sup>2</sup>C standard. This much information should be enough through this course. However, if you are interested in the I<sup>2</sup>C protocol further then the full specification is available <a class="reference external" href="https://www.pololu.com/file/0J435/UM10204.pdf">here</a>.</p>
</section>
<section id="example">
<h2><span class="section-number">8.1.2. </span>Example<a class="headerlink" href="#example" title="Permalink to this heading">#</a></h2>
<p>Let’s consider an example to better understand the I<sup>2</sup>C protocol. Following diagrams show I<sup>2</sup>C communication between the μC and an <a class="reference external" href="https://ww1.microchip.com/downloads/en/DeviceDoc/25095A.pdf">MCP9808</a> temperature sensor. Correct way to read these diagrams is to look for the SDA voltage values when SCL line is high.</p>

<div style="overflow-x:auto">
<script type="WaveDrom">
{signal: [
    {
        node: 'A..BC.....D.....E.....F.....G.....H.....I.....J.....K.....L',
        period: 0.5,
    },
    {
        name: 'SDA',
        wave: '10..............1...........0.............................',
        period: 0.5
    },
    {
        name: 'SCL',
        wave: '1..l..H..l..H..l..H..l..H..l..H..l..H..l..H..l..H..l..H..l',
        period: 0.5
    }
],
edge: ['A<->B S', 'C<->J 7-bit Target Address', 'J<->K Write', 'K<->L Ack'
],
config: {skin:'narrow'
}
}
</script>
</div>
<p>In the diagram above, the μC sends a start bit. It is followed by the 7-bit target address, <code class="docutils literal notranslate"><span class="pre">0b0011000</span></code> defined on <a class="reference external" href="https://ww1.microchip.com/downloads/en/DeviceDoc/25095A.pdf#page=14">pg. 14</a> of the datasheet. Note that the information is sent MSB (Most Significant Bit) first here as opposed to LSB first in the case of UART. Finally, the controller specifies that it wants to write to the target by sending a 0. After this, the target sends an Ack by sending a 0.</p>

<div style="overflow-x:auto">
<script type="WaveDrom">
{signal: [
    {
        node: '.C.....D.....E.....F.....G.....H.....I.....J.....K.....L',
        period: 0.5,
        phase: -0.5
    },
    {
        name: 'SDA',
        wave: '0..............................1.....0.....1.....0.....',
        period: 0.5,
        phase: -0.5
    },
    {
        name: 'SCL',
        wave: '0..H..l..H..l..H..l..H..l..H..l..H..l..H..l..H..l..H..l',
        period: 0.5,
        phase: -0.5
    }
],
edge: ['C<->K 8-bit Data from Controller', 'K<->L Ack'
],
config: {skin:'narrow'
}
}
</script>
</div>
<p>Since the controller specified that it wants to write to the target, it sends 8-bits of data. This data is generally referred to as a <strong>Command</strong> or a <strong>Register</strong>. In this case, the command is <code class="docutils literal notranslate"><span class="pre">0b00000101</span></code>, which tells the target that the controller wants to receive temperature values in the next message (<a class="reference external" href="https://ww1.microchip.com/downloads/en/DeviceDoc/25095A.pdf#page=16">pg. 16</a> of the datasheet). The target sends an Ack upon correctly identifying the command/register. Note that the end of the message should be indicated by the μC here by sending a stop condition. This would have been fine if there was only one controller present.</p>

<div style="overflow-x:auto">
<script type="WaveDrom">
{signal: [
        {
        node: '..A...BC.....D.....E.....F.....G.....H.....I.....J.....K.....L',
        period: 0.5,
        phase: -0.5
        },
        {
        name: 'SDA',
        wave: '01..0..............1...........0.................1.....0.....',
        period: 0.5,
        phase: -0.5
        },
        {
        name: 'SCL',
        wave: '0..H..l..H..l..H..l..H..l..H..l..H..l..H..l..H..l..H..l..H..l',
        period: 0.5,
        phase: -0.5
        }
    ],
edge: ['A<->B S', 'C<->J 7-bit Target Address', 'J<->K Read', 'K<->L Ack'
    ],
config: {skin:'narrow'
    }
}
</script>
</div>
<p>Instead, it sends a start condition. This situation is termed as <strong>Repeated Start</strong>. This is necessary if there are more than one controllers present and one of them wants to retain control of the SCL and SDA lines over multiple messages. Note that the complete communication in this example contains two messages that finally result in the controller attaining one reading from the temperature sensor. If the controller had sent a stop condition then another controller might have gained the control of SCL and SDA lines and this communication would not have completed. Apart from this, the other difference here is the μC now a read operation to the target, which is then acknowledged by the target.</p>

<div style="overflow-x:auto">
<script type="WaveDrom">
{signal: [
        {
        node: '.C.....D.....E.....F.....G.....H.....I.....J.....K.....L',
        period: 0.5,
        phase: -0.5
        },
        {
        name: 'SDA',
        wave: '0..........................................1.....0.....',
        period: 0.5,
        phase: -0.5
        },
        {
        name: 'SCL',
        wave: '0..H..l..H..l..H..l..H..l..H..l..H..l..H..l..H..l..H..l',
        period: 0.5,
        phase: -0.5
        }
    ],
edge: ['C<->K 8-bit Data from Target', 'K<->L Ack'
    ],
config: {skin:'narrow'
    }
}
</script>
</div>
<p>Here, the target is sending first 8-bits of information, which is <code class="docutils literal notranslate"><span class="pre">0b00000001</span></code> in this case, and the controller is acknowledging the receipt of those 8-bits.</p>

<div style="overflow-x:auto">
<script type="WaveDrom">
{signal: [
    {
        node: '.C.....D.....E.....F.....G.....H.....I.....J.....K.....LM...N',
        period: 0.5,
        phase: -0.5
    },
    {
        name: 'SDA',
        wave: '01.....0...........1.....0.....1.....0...........1.....0..1.',
        period: 0.5,
        phase: -0.5
    },
    {
        name: 'SCL',
        wave: '0..H..l..H..l..H..l..H..l..H..l..H..l..H..l..H..l..H..l..H..',
        period: 0.5,
        phase: -0.5
    }
],
edge: ['C<->K 8-bit Data from Target', 'K<->L Nack', 'M<->N St'
],
config: {skin:'narrow'
}
}
</script>
</div>
<p>Here, the target is sending the second byte, which is <code class="docutils literal notranslate"><span class="pre">0b10010100</span></code>, and then the controller indicates the end of message by sending a Nack and then a stop condition. Note that the number of bytes to be written or read by the controller is not predefined. It is up to the manufacturer to decide how the information should be formatted. Take a look at <a class="reference external" href="https://ww1.microchip.com/downloads/en/DeviceDoc/25095A.pdf#page=24">Section 5.1.3</a> of the datasheet to understand what the 2-bytes of data received by the controller mean.</p>
</section>
<section id="baud-rate">
<h2><span class="section-number">8.1.3. </span>Baud Rate<a class="headerlink" href="#baud-rate" title="Permalink to this heading">#</a></h2>
<p>Similar to UART, I<sup>2</sup>C protocol can also work at different Baud rates. Since I<sup>2</sup>C is a synchronous protocol, the devices communicating through I<sup>2</sup>C don’t have to know the baud rate. However, different devices may have a limitation on the maximum baud rate they support. So, the controller has to make sure that it is communicating at the baud rate that the target it is addressing to can handle. Following table lists the supported I<sup>2</sup>C baud rates.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p>Mode</p></th>
<th class="head text-center"><p>Standard</p></th>
<th class="head text-center"><p>Fast</p></th>
<th class="head text-center"><p>Fast+</p></th>
<th class="head text-center"><p>High-Speed</p></th>
<th class="head text-center"><p>Ultra-Fast</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p><strong>Speed</strong></p></td>
<td class="text-center"><p>100 kb/s</p></td>
<td class="text-center"><p>400 kb/s</p></td>
<td class="text-center"><p>1 Mb/s</p></td>
<td class="text-center"><p>3.4 Mb/s</p></td>
<td class="text-center"><p>5 Mb/s</p></td>
</tr>
</tbody>
</table>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./chap08/sec01"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>
    <script type="text/javascript">
        function init() {
            WaveDrom.ProcessAll();
        }
        window.onload = init;
    </script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../i2c.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">8. </span>Inter-Integrated Circuit</p>
      </div>
    </a>
    <a class="right-next"
       href="../sec02/libraryFunctions.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">8.2. </span><code class="docutils literal notranslate"><span class="pre">hardware_i2c</span></code> Library Functions</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#i-sup-2-sup-c-message">8.1.1. I<sup>2</sup>C Message</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example">8.1.2. Example</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#baud-rate">8.1.3. Baud Rate</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Vatsal Asitkumar Joshi
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=927b94d3fcb96560df09"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=927b94d3fcb96560df09"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>